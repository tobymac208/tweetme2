{% extends 'base.html' %}

{% block head_title %}
Isn't she beautiful?
{% endblock head_title %}

{% block content %}
<h1>Welcome to Tweet Me 2!</h1>

<div id="tweets">
    Loading...
</div>

<script>
    const tweetsElement = document.getElementById('tweets');
    /* Requesting the data from the django back-end.
    It is going to grab the JSON data. */
    const xhr = new XMLHttpRequest();
    const method = 'GET';
    const url = '/tweets';
    const responseType = 'json';

    function formatTweetFunction(item) {
        return `<div class='mb-4'><h1>${item.id}</h1> <p>${item.content}</p></div>`;
    }

    xhr.responseType = responseType;
    xhr.open(method, url);
    xhr.onload = function () {
        const serverResponse = xhr.response;
        const listedItems = serverResponse.response;

        var stringBuffer = '';
        for (let i = 0, len = listedItems.length; i < len; i++) {
            stringBuffer += formatTweetFunction(listedItems[i]);
        }
        tweetsElement.innerHTML = stringBuffer;
    }
    xhr.send();
</script>
{% endblock content%}